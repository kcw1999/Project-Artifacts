Complete Summary of Our Discussion
Problem Statement
Your organization needed to adapt MITRE SAF framework from containers to VMs
Management wanted to use VMware STIG Appliance alongside existing GitLab/AAP infrastructure
Goal: Create golden image pipeline for VM templates with automated hardening, scanning, and compliance validation
Key Insights Discovered
AAP Was Unnecessary: The VMware STIG Appliance contains all needed tools (CINC, SAF CLI, Ansible), eliminating the need for AAP orchestration
SAF CLI Handles Everything: MITRE's SAF CLI provides built-in functionality for:
Attestation (saf attest apply)
Threshold validation (saf validate threshold)
Results visualization (saf view summary)
Heimdall upload (via curl)
Simplified Architecture: Direct GitLab CI → STIG Appliance → Target VM flow reduces complexity by 50%
Final Solution Architecture
Components:
GitLab CI/CD: Pipeline orchestration and artifact management
STIG Appliance: Compliance execution engine with pre-installed tools
vCenter: VM lifecycle management and template storage
Heimdall: Compliance visualization and reporting
Pipeline Flow:
Deploy: Create VM from base template
Scan: Run baseline compliance scan
Harden: Apply STIG hardening content
Validate: Run post-hardening compliance scan
Attest: Apply attestations using SAF CLI
Upload: Send results to Heimdall
Promote: Convert compliant VM to golden template
Cleanup: Delete ephemeral VM
Key Benefits Achieved
Cost Reduction: Eliminated AAP licensing for this workflow
Complexity Reduction: 50% fewer infrastructure components
True MITRE Alignment: Uses SAF CLI exactly as designed
Leverages STIG Appliance: Uses VMware's specialized compliance tooling
Golden Image Pipeline: Shift-left security with compliant templates
Automated Compliance: No manual intervention required